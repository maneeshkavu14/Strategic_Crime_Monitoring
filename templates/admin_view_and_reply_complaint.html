<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Crime Management</title>
    <!-- base:css -->
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/mdi/css/materialdesignicons.min.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/feather/feather.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/base/vendor.bundle.base.css')}}">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/flag-icon-css/css/flag-icon.min.css')}}" />
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/font-awesome/css/font-awesome.min.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/jquery-bar-rating/fontawesome-stars-o.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='vendors/jquery-bar-rating/fontawesome-stars.css')}}">
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="{{url_for('static',filename='css/style.css')}}">
    <!-- endinject -->
    <link rel="shortcut icon" href="{{url_for('static',filename='images/favicon.png')}}" />
</head>

<body>
    <div class="container-scroller">
        <!-- partial:partials/_navbar.html -->
        <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
           <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center" style="background-color: rgb(50, 44, 92)!important;">
                <a class="navbar-brand brand-logo"  style="color:beige" href="admin">CRIME</a>
                <a class="navbar-brand brand-logo-mini" href="admin"><img src="{{url_for('static',filename='images/logo-mini.svg')}}" alt="logo" /></a>
            </div>
            <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
            
                <ul class="navbar-nav navbar-nav-right">
                  
                    <li class="nav-item dropdown mr-4 d-lg-flex d-none">
                        <a class="nav-link count-indicatord-flex align-item s-center justify-content-center" href="admin">
                            <i class="icon-box menu-icon"></i>
                            <span class="menu-title">Home</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown mr-4 d-lg-flex d-none">
                        <a  class="nav-link count-indicatord-flex align-item s-center justify-content-center" id="notificationDropdown" href="admin_home" data-toggle="dropdown">
                            <i class="icon-pie-graph menu-icon"></i>
                            <span class="menu-title">Stations</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                            <!-- <p class="mb-0 font-weight-normal float-left dropdown-header">Settings</p> -->
                            <a class="dropdown-item preview-item" href="/admin_add_station">
                                <i class="icon-file menu-icon"></i>
                                <span class="menu-title">Add Station</span>
                            </a>
                            <a class="dropdown-item preview-item" href="/admin_add_station_employee">
                                <i class="icon-file menu-icon"></i>
                                <span class="menu-title">Add Employee</span>
                            </a>
                    
                        </li>
                        <li class="nav-item dropdown mr-4 d-lg-flex d-none">
                            <a  class="nav-link count-indicatord-flex align-item s-center justify-content-center" id="notificationDropdown" href="admin_home" data-toggle="dropdown">
                                <i class="icon-head menu-icon"></i>
                                <span class="menu-title">Advocates</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                                <!-- <p class="mb-0 font-weight-normal float-left dropdown-header">Settings</p> -->
                                <a class="dropdown-item preview-item" href="/admin_add_advocate_admin">
                                    <i class="icon-file menu-icon"></i>
                                    <span class="menu-title">Add Advocate Admin</span>
                                </a>
                                <a class="dropdown-item preview-item" href="/view_manage_advocate">
                                    <i class="icon-pie-graph menu-icon"></i>
                                    <span class="menu-title">Manage Advocate Admin</span>
                                </a>
                              
                            </li>
                            <li class="nav-item dropdown mr-4 d-lg-flex d-none">
                                <a  class="nav-link count-indicatord-flex align-item s-center justify-content-center" id="notificationDropdown" href="admin_home" data-toggle="dropdown">
                                    <i class="icon-head menu-icon"></i>
                                    <span class="menu-title">Users</span>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                                    <!-- <p class="mb-0 font-weight-normal float-left dropdown-header">Settings</p> -->
                                    <a class="dropdown-item preview-item" href="/admin_view_user">
                                        <i class="icon-eye"></i>
                                        <span class="menu-title">View User</span>
                                    </a>
                                   
                                </li>
                                <li class="nav-item dropdown mr-4 d-lg-flex d-none">
                                    <a  class="nav-link count-indicatord-flex align-item s-center justify-content-center" id="notificationDropdown" href="admin_home" data-toggle="dropdown">
                                        <i class="icon-file menu-icon"></i>
                                        <span class="menu-title">Complaints</span>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                                        <!-- <p class="mb-0 font-weight-normal float-left dropdown-header">Settings</p> -->
                                       
                                        <!-- <a class="dropdown-item preview-item" href="/admin_manage_personal_complaint">
                                            <i class="icon-help menu-icon"></i>
                                            <span class="menu-title">Manage Personal Complaints</span>
                                        </a> -->
                                        <a class="dropdown-item preview-item" href="/admin_manage_normal_complaint">
                                            <i class="icon-help menu-icon"></i>
                                            <span class="menu-title">Manage Normal Complaints</span>
                                        </a>
                                        <a class="dropdown-item preview-item" href="/admin_view_spot_complaints">
                                            <i class="icon-help menu-icon"></i>
                                            <span class="menu-title">Spot Complaints</span>
                                        </a>
                                    </li>
                            <li class="nav-item dropdown d-flex mr-4 ">
                                <a class="nav-link count-indicator dropdown-toggle d-flex align-items-center justify-content-center" id="notificationDropdown" href="/logout">
                                    <i class="fa fa-sign-out" aria-hidden="true"></i> Logout
                                </a>
                                
                            </li>
                        </div>
                    </li>
                    
                </ul>
                <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
                    <span class="icon-menu"></span>
                </button>
            <!-- </div> -->
        </nav>
        <!-- partial -->
        <div class="container-fluid page-body-wrapper">
            <!-- partial:partials/_sidebar.html -->
        
            <!-- partial -->
            <div class="main-panel" style="margin: auto;">
                <div class="content-wrapper">
                    <div class="row">
                        <div class="col-sm-12 mb-4 mb-xl-0">
                            <h4 class="font-weight-bold text-dark">System Complaint</h4>
                            <!-- <p class="font-weight-normal mb-2 text-muted">APRIL 1, 2019</p> -->
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-xl-12 flex-column d-flex grid-margin stretch-card">

                            <div class="row flex-grow">
                                {% for row in row%}
                                <div class="col-sm-3 grid-margin stretch-card">

                                    <div class="card">
                                        <div class="card-body">
                                            <h4 class="card-title"></h4>

                                            <h4 class="text-dark font-weight-bold mb-2">{{row[2]}}</h4>
                                            <p><span style="color: rgb(153, 0, 255);">Reply:-</span> {{row[3]}}</p>


                                            <button class="btn btn-primary btn-sm" onclick="get_id({{row[0]}})" data-toggle="modal" data-target="#exampleModal">Reply</button>

                                        </div>
                                    </div>

                                </div>
                                {% endfor %}

                            </div>
                        </div>
                    </div>
                    <script>
                        function get_id(id) {
                            console.log(id)
                            sessionStorage.setItem('key', id);
                        }


                        function send_reply() {
                            console.log('re')
                            console.log(document.getElementById('reply').value)

                            var dt = {
                                complaint_id: sessionStorage.getItem('key'),
                                reply: document.getElementById('reply').value
                            }


                            fetch("http://127.0.0.1:5000/admin_view_and_reply_complaint", {
                                method: "POST",
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(dt)
                            }).then(res => {
                                console.log("Request complete! response:", res);
                                window.location.reload();
                            });


                        }
                    </script>
                    <!-- Modal -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Complaint Reply</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">&times;</span>
         </button>
                                </div>
                                <div class="modal-body">

                                    <div class="form-group col-6">
                                        <input class="form-control" type="hidden" name="compid" value="{{row[0][0]}}">
                                        <label for="reply"><b>Reply:</b></label>
                                        <textarea value="" id="reply" name="reply" required></textarea>
                                    </div>
                                </div>
                                <div class="modal-footer">

                                    <button type="submit" onclick="send_reply()" class="btn btn-primary">Submit</button>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
                <!-- content-wrapper ends -->
                <!-- partial:partials/_footer.html -->
               
                <!-- partial -->
            </div>
            <!-- main-panel ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->

    <!-- base:js -->
    <script src="{{url_for('static',filename='vendors/base/vendor.bundle.base.js')}}"></script>
    <!-- endinject -->
    <!-- Plugin js for this page-->
    <!-- End plugin js for this page-->
    <!-- inject:js -->
    <script src="{{url_for('static',filename='js/off-canvas.js')}}"></script>
    <script src="{{url_for('static',filename='js/hoverable-collapse.js')}}"></script>
    <script src="{{url_for('static',filename='js/template.js')}}"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="{{url_for('static',filename='vendors/chart.js/Chart.min.js')}}"></script>
    <script src="{{url_for('static',filename='vendors/jquery-bar-rating/jquery.barrating.min.js')}}"></script>
    <!-- End plugin js for this page -->
    <!-- Custom js for this page-->
    <script src="{{url_for('static',filename='js/dashboard.js')}}"></script>
    <!-- End custom js for this page-->
</body>

</html>